---
import RainBackground from './Rain.astro';
---

<RainBackground />

<nav class="navbar">
    <div class="nav-container">
        <ul class="nav-menu">
            <li><a href="#home" class="nav-link">home</a></li>
            <li><a href="#about" class="nav-link">about</a></li>
            <li><a href="#projects" class="nav-link">projects</a></li>
            <li><a href="#contact" class="nav-link">contact</a></li>
        </ul>
    </div>
</nav>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('.section');

    const updateActiveLink = () => {
        let currentSection = '';

        sections.forEach((section) => {
            const sectionTop = (section as HTMLElement).offsetTop;
            const sectionId = section.getAttribute('id');
            
            if (window.scrollY >= sectionTop - 100 && sectionId) {
                currentSection = sectionId;
            }
        });

        navLinks.forEach((link) => {
            link.classList.remove('active');
            const href = link.getAttribute('href');
            
            if (href && href.substring(1) === currentSection) {
                link.classList.add('active');
            }
        });
    };

    navLinks.forEach((link) => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            
            const href = link.getAttribute('href');
            if (href && href.startsWith('#')) {
                const targetId = href.substring(1);
                
                // Update active link immediately
                navLinks.forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                
                // Scroll to target with smooth behavior
                if (targetId === 'home') {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                } else {
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                }
            }
        });
    });

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>