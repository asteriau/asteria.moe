---
import RainBackground from './Rain.astro';

const currentPath = Astro.url.pathname;
---

<RainBackground />

<nav class="navbar">
    <div class="nav-container">
        <ul class="nav-menu">
            <li><a href="/" class:list={['nav-link', { active: currentPath === '/' }]}>home</a></li>
            <li><a href="/about" class:list={['nav-link', { active: currentPath === '/about' }]}>about</a></li>
            <li><a href="/projects" class:list={['nav-link', { active: currentPath === '/projects' }]}>projects</a></li>
            <li><a href="/contact" class:list={['nav-link', { active: currentPath === '/contact' }]}>contact</a></li>
        </ul>
    </div>
</nav>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const navContainer = document.querySelector('.nav-container');

    if (!navContainer) {
        console.error('Navigation container not found');
        return;
    }

    const navIndicator = document.createElement('div');
    navIndicator.className = 'nav-indicator';
    navContainer.appendChild(navIndicator);

    const updateIndicatorPosition = () => {
        const activeLink = document.querySelector('.nav-link.active');
        if (!activeLink || !navIndicator || !navContainer) return;

        const linkRect = activeLink.getBoundingClientRect();
        const containerRect = navContainer.getBoundingClientRect();
        const relativeLeft = linkRect.left - containerRect.left;

        navIndicator.style.width = `${linkRect.width}px`;
        navIndicator.style.left = `${relativeLeft}px`;
        navIndicator.style.bottom = '0';
    };

    updateIndicatorPosition();

    window.addEventListener('resize', updateIndicatorPosition);
});
</script>